/**
 * vorm - v0.1.0
 * update: 2015-03-10
 * Author: YusukeHirao []
 * Github: https://github.com/YusukeHirao/vorm.git
 * License: Licensed under the MIT License
 */


(function(){"use strict";var a,b=this,c="process"in b,d=function(){function a(b,c){return this instanceof a?void this._init(b,c):new a(b,c)}return a.prototype.onReady=function(a){this._readyHandler=a,this._isReadied&&this._readyHandler.call(this)},a.prototype._init=function(a,b){this._isReadied="complete"===window.document.readyState,this._isReadied?this._createVormObject(a,b):window.addEventListener("DOMContentLoaded",this._createVormObject.bind(this,a,b),!1)},a.prototype._createVormObject=function(a,b){this._isReadied=!0;var c;if("string"==typeof a){if(c=document.querySelector('[name="'+a+'"]'),!c)throw new TypeError("A Form element was not found by name: "+a)}else if(c=a,!c.nodeName)throw new TypeError("Type of a first argument is not HTMLElement");if("FORM"!==c.nodeName)throw new TypeError("A got element is not a Form element");this.form=c,this.fields=new i(this,b),this._readyHandler&&this._readyHandler.call(this)},a}(),e=function(){function a(a){this.name=null,this.params=[],this.dependence=[];var b,c,d,e=new RegExp(m.paramVariablePrefix.replace(/\$/g,"\\$")+"[0-9]+","ig");a&&a[0]&&(b=a[0].match(e),c=a[0].replace(e,""),b&&b[0]&&(d=b[0].replace(e,function(a){return m.paramList[a]}),d=d.slice(1,-1)));var f,g=c.split(".");g&&g.length&&(c=g.shift(),f=g[0]),this.method=c,this.option=f,d&&(this.params=d.split(/,/).map(function(a){return a.trim()}))}return a.prototype.toString=function(){return this.name+":"+this.method},a}(),f=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},g=function(b){function c(c){b.call(this,c),this.name="convert",this.priority=1e4;var d=a[this.method];d&&d.convert&&(this._customConvert=d.convert),console.log("%c"+this.name,"color: orange; font-weight: bold",this.method,this.option,this.params)}return f(c,b),c.prototype.convert=function(a){var b={};return b[this.option]=!0,this._customConvert?this._customConvert(a,b,this.params):a},c}(e),h=function(){function a(a,b){switch(this.required=!1,this.el=a,this.name=a.name,a.nodeName){case"INPUT":this.type=a.type;break;case"SELECT":this.type="select";break;case"TEXTAREA":this.type="textarea";break;default:throw new TypeError("")}this.rules=m.queryRuleSet(b),this.bindEvent(),this.update()}return a.prototype.update=function(){var a=this;_.each(this.rules,function(b){if(b)switch(b.name){case"required":b.when||(a.required=!0)}})},a.prototype.bindEvent=function(){var a=this;this.el.addEventListener("blur",function(b){var c=b.target;c.value=a._convert(c.value),a._is(c.value)?a.el.classList.remove("invalid"):a.el.classList.add("invalid")})},a.prototype._convert=function(a){var b=a;return _.each(this.rules,function(a){a&&"convert"===a.name&&(b=a.convert(b))}),b},a.prototype._is=function(a){var b=!0;return _.each(this.rules,function(c){c&&"is"===c.name&&(console.log(c.name,c.method),c.filter(a)||(b=!1))}),b},a}(),i=function(){function a(a,b){this._=[],this.__={};var c,d,e,f,g;for(c in b)if(b.hasOwnProperty(c)){if(d=b[c],e=a.form.querySelector('[name="'+c+'"]'),!e)throw new Error('Invaid option. Not found element of [name="'+c+'"].');g=new h(e,d),f=this._.length,this._[f]=g,this.__[c]=f}}return a.prototype.ref=function(a){return"string"==typeof a?this._[this.__[a]]:this._[a]},a}(),j=function(){function a(){this.name="group",this.params=[],this.priority=1e4,this.dependence=[]}return a}(),k=function(b){function c(c){b.call(this,c),this.name="is",this.priority=100;var d=a[this.method];d&&d.is&&(this._customFilter=d.is),console.log("%c"+this.name,"color: green; font-weight: bold",this.method,this.option,this.params)}return f(c,b),c.prototype.filter=function(a){var b={};return b[this.option]=!0,this._customFilter?this._customFilter(a,b,this.params):!0},c}(e),l=function(){function a(){this.name="required",this.method="normal",this.params=[],this.priority=1e3,this.dependence=[]}return a}(),m=function(){function a(){}return a.queryRuleSet=function(b){var c=(b.replace(/(?:"[^"]*")|('[^']*')/g,function(b){var c=a.quotedStringVariablePrefix+a.quotedStringVariableCounter;return a.quotedStringList[c]=b,a.quotedStringVariableCounter++,c}),b.replace(/\([^\(]*\)/g,function(b){var c=a.paramVariablePrefix+a.paramVariableCounter;return a.paramList[c]=b,a.paramVariableCounter++,c})),d=c.split(/\s+/g),e=_.map(d,function(a){var b,c=a.split(":"),d=c.shift(),e=c;switch(d.toLowerCase()){case"required":case"require":b=new l;break;case"is":b=new k(e);break;case"convert":b=new g(e);break;case"write":b=new n(e);break;default:if(!/^@/.test(d))return;b=new j(e)}return b});return e},a.nodeStringify=function(a){var b=a.nodeName||"UnknownNode",c=a.id||"",d=a.className.split(/\s+/g)||[],e=a.type||"",f=b;return e&&(f+=":"+e),c&&(f+="#"+c),d.length&&(f+="."+d.join(".")),f},a.getFormName=function(){var b,c,d=[],e=document.querySelectorAll("form [name]"),f=e.length;for(c=0;f>c;c++)b=e[c],d.push(b.name?b.name:"[name is empty]: "+a.nodeStringify(b));return d.join("\n")},a.parseComparison=function(a,b){var c,d,e,f,g,h,i=a.match(/(?:<|>)?=?/i);if(!i&&!i.length)throw new Error;if(c=i[0],d=a.split(c),e=d[0]||b,f=d[1],"="===c)return e===f;switch(g=new jaco.Jaco(e).toNumber(),h=new jaco.Jaco(f).toNumber(),c){case"<":return h>g;case">":return g>h;case"<=":return h>=g;case">=":return g>=h}return!0},a.zerofill=function(a,b){return(new Array(b).join("0")+a).slice(-1*b)},a.quotedStringVariablePrefix="$______",a.paramVariablePrefix="$$______",a.quotedStringList={},a.quotedStringVariableCounter=0,a.paramList={},a.paramVariableCounter=0,a}(),n=function(){function a(){this.name="write",this.params=[],this.priority=1e4,this.dependence=[]}return a}();!function(a){a.hiragana={convert:function(a){return jaco.hiraganize(a)},is:function(a){return new jaco.Jaco(a).isOnlyHiragana()}}}(a||(a={}));var a;!function(a){a.katakana={convert:function(a){return jaco.katakanize(a)},is:function(a){return new jaco.Jaco(a).isOnlyKatakana()}}}(a||(a={}));var a;!function(a){a.integer={convert:function(a,b,c){return b.zerofill?m.zerofill(new jaco.Jaco(a).toNumeric(!1,!1).toString(),+c[0]):new jaco.Jaco(a).toNumeric(b.unsigned,!1).toString()},is:function(a,b){return new jaco.Jaco(a).isNumeric(b.unsigned||b.zerofill,!1)}}}(a||(a={}));var a;!function(a){a.comparison={is:function(a,b,c){return m.parseComparison(c[0],a)}}}(a||(a={}));var a;!function(a){a.beautify={convert:function(a){return new jaco.Jaco(a).toNarrow().toWideKatakana().replaceMap({"~":"〜","\\(":"（","\\)":"）"}).toString()}}}(a||(a={}));var a;!function(a){var b=/^([0-9a-z\.!\#$%&'*+\-\/=?^_`{|}~\(\)<>\[\]:;@,"\\\u0020]+)@((?:[0-9a-z][0-9a-z-]*\.)+[0-9a-z]{2,6}|\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\])$/i,c=/^".+"$/g,d=/^"|"$/g,e=/\\"|\\\\/g,f=/"|\\/,g=/^\.|\.{2,}|\.$/i,h=/^[0-9a-z\.!#$%&'*+\-\/=?^_`{|}~]+$/i;a.email={is:function(a){var i,j,k,l;return a.length>256?!1:(i=a.match(b))?(j=i[1],k=i[2],k.length>255?!1:j.length>64?!1:c.test(j)?(j=j.replace(d,""),l=j.replace(e,""),f.test(l)?!1:!0):g.test(j)?!1:h.test(j)?!0:!1):!1}}}(a||(a={}));var a;!function(a){a.length={is:function(a,b,c){return new jaco.Jaco(a).size()===new jaco.Jaco(c[0]).toNumber()}}}(a||(a={}));var a;!function(a){a.maxlength={is:function(a,b,c){return new jaco.Jaco(a).size()<=new jaco.Jaco(c[0]).toNumber()}}}(a||(a={})),d.util=m,c?module.exports=d:b.vorm=d}).call((this||0).self||global);
//# sourceMappingURL=vorm.min.js.map